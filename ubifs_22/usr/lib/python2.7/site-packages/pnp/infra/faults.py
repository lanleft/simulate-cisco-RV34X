################################################################################
# Copyright (c) 2018 by Cisco Systems, Inc.
# All rights reserved.
#
# Author: Andrew Au <aau@cisco.com>
################################################################################
""" PnP Faults

This file contains definitions of the fault code & string to be used in Fault
Response to be sent back to the Server.

They align with what's used in the IOS Agent, except the exclusion of the prefix
'XSVC' in all those contents, as it's inapplicable in the Posix Agent's case.

"""
from collections import namedtuple

pnp_fault_code = {
    'PNP_SENDER_FAULT': 'POSIX-PNP:Server',
    'PNP_RECEIVER_FAULT': 'POSIX-PNP:Client'
    }

pnp_fault_string = {
    'PNP_FAULT_STR_UNKNOWN_NAMESPACE': 'Unknown namespace received',
    'PNP_FAULT_STR_AUTHORIZATION_FAILED': ('The user is not authorised '
                                           'to execute that request'),
    'PNP_FAULT_STR_AUTHENTICATION_FAILED': ('A valid user has not been '
                                            'identified'),
    'PNP_FAULT_STR_OPERATION_FAILED': 'the operation aborted',
    'PNP_FAULT_STR_INTERNAL': ('An internal error caused processing to '
                               'be aborted'),
    'PNP_FAULT_STR_NOT_SUPPORTED': ('An unsupported operation request has '
                                    'been received')
    }


# Define the class FaultInfo and use namedtuple to store its 3 fields of
# info for a generated fault:
#     code (str): Fault code of the fault.
#     strng (str): Human readable message describing the fault.
#     details (str): Human readable message describing further details
#         about the fault.
FaultInfo = namedtuple('fault_info', ['code', 'string', 'details'])
