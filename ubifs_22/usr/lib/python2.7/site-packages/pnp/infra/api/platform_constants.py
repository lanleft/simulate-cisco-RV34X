################################################################################
# Copyright (c) 2015-17 by Cisco Systems, Inc.
# All rights reserved.
#
# Author: Shaurin Desai <shaurdes@cisco.com>
################################################################################
"""PnP Infra API: Platform Constants

This file serves as the Platform Constants API signature.

These constants values must be provided for each platform that hosts a POSIX PnP
Agent. If the pnp_platform.infra.platform_constants module does not contain one
of the attributes in this file, then the default value defined in this file will
be used.

Todo:
    * Provide set of acceptable values for relevant module level variables

"""
################################################################################
#
# File Paths
#
################################################################################
PLATFORM_FILE_PATHS = ''
"""str: Platform file paths config that is installed by pnp_platform module.

Sample value: '/etc/pnp_platform/platform_paths.cfg'
"""

FILE_PATHS = '/etc/pnp/platform_paths.cfg'
"""str: Default file paths config that is installed by pnp module."""

################################################################################
#
# Transport and Protocol
#
################################################################################
IPV6_ENABLED = False
"""bool: Only set to True if system and pnp_platform implementation support
IPv6. Setting to True will enable PnP Discovery over IPv6.
"""

CCO_URL_RESOLVER_TIMER = 30
"""int: Timeout value for CCO Server DNS resolution (PnP Connect)."""

DNS_URL_RESOLVER_TIMER = 30
"""int: Timeout value for DNS resolution of any FQDN."""

################################################################################
#
# Security (Cisco Product Security Baseline must be followed)
#
################################################################################
DEFAULT_CERTS_ENABLED = False
"""bool: If set to True, default OpenSSL certificates made available on the
system can be used to verify SSL connections. Default certificates are
determined by OpenSSL installation (usually /etc/ssl/certs/ca-bundle.crt).
"""

from ssl import PROTOCOL_TLSv1_2  # pylint: disable=no-name-in-module
CSDL_SSL_PROTOCOL = PROTOCOL_TLSv1_2
"""ssl protocol constant: Set the accepted protocol version for SSL connections.
Protocol version used should be according to Cisco Product Security Baseline.
"""

CSDL_SSL_CHECK_HOSTNAME = True
"""bool: If set to True, hostname identity check will be enforced during TLS
handshake (RFC 6125). Disabling this check is NOT recommended and will introduce
a security risk.
"""

CSDL_CIPHERS = ('ECDHE-RSA-AES128-GCM-SHA256', 'ECDHE-ECDSA-AES128-GCM-SHA256',
                'ECDHE-ECDSA-AES256-GCM-SHA384', 'ECDHE-RSA-AES256-GCM-SHA384',
                'AES256-SHA256:AES128-SHA256', 'DHE-RSA-AES256-GCM-SHA384',
                'AES256-GCM-SHA384', 'DHE-RSA-AES128-GCM-SHA256',
                'AES128-GCM-SHA256', 'DHE-DSS-AES128-SHA', 'DHE-RSA-AES128-SHA',
                'ECDHE-ECDSA-AES256-SHA384', 'ECDHE-RSA-AES128-SHA256',
                'ECDHE-ECDSA-AES128-SHA256', 'ECDHE-RSA-AES256-SHA384',
                'AES128-SHA', 'DHE-DSS-AES128-SHA256',
                'DHE-DSS-AES128-GCM-SHA256', 'DHE-DSS-AES256-GCM-SHA384',
                'DHE-RSA-AES128-SHA256', 'DHE-RSA-AES256-SHA256',
                'DHE-DSS-AES256-SHA256', 'ECDHE-RSA-AES128-SHA',
                'ECDHE-ECDSA-AES128-SHA')
"""tuple: list of acceptable TLS ciphers to use. TLS ciphers should be selected
according to Cisco Product Security Baseline.
"""

################################################################################
#
# Logging
#
################################################################################
LOG_MSG_FORMAT = "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
"""str: Format string that is used for logging messages."""

LOG_MAX_BYTES = 2097152  # 2 MB (1024 x 1024 x 2)
"""int: Max size of log file (Bytes). Defaults to 2MB."""

LOG_BACKUP_COUNT = 1
"""int: Number of backup log files that will be used for log file rotation."""
